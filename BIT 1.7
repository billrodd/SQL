/ SELECT * FROM BIT_DB.customers LIMIT 20;
#1// SELECT distinct orderid, count(*) as cnt FROM BIT_DB.JanSales group by orderid;

select orderID, count(*) as cnt from 
BIT_DB.JanSales
group by orderid having count (*) > 1

 SELECT distinct orderid FROM BIT_DB.JanSales group by orderid;
 SELECT COUNT(orderid)
FROM BIT_DB.JanSales

select distinct product, count(*) as productcount from BIT_DB.JanSales group by product

select * from BIT_DB.JanSales where orderid =  141275

// SELECT * FROM BIT_DB.JanSales;
#2// SELECT count (Product) as Count, Product FROM BIT_DB.JanSales
WHERE Product ="iPhone";

select *  from BIT_DB.FebSales where orderID IS 'Order ID';

SELECT  distinct cust.acctnum
FROM  BIT_DB.customers cust
left join BIT_DB.FebSales Feb
on  cust.order_ID = Feb.orderID where Feb.orderID IS NULL;

SELECT  distinct cust.acctnum, feb.orderID, cust.
FROM  BIT_DB.customers cust
Inner join BIT_DB.FebSales Feb
on  cust.order_ID = Feb.orderID where Feb.OrderID = 'Order ID';





select * from BIT_DB.customers limit 20

select * from BIT_DB.customers where order_ID = 'Order ID'



#4 //

select * from BIT_DB.FebSales where OrderID = 'Order ID'

/*
Which product was the cheapest one sold in January, and what was the price? 
For this one, you are going to use the commands distinct and MIN(). Using 
'SELECT distinct' will remove duplicate rows from your results.
 The MIN() command will allow you to select the smallest value from the price column.
  This is a hard one - see if you can do it, but don't be afraid to look at the hint or answer if you need to!
*/

select product, min(price) as minprice from BIT_DB.JanSales  group by product order by price asc

/*
What is the total revenue for each product sold in January?
 (Revenue can be calculated using the number of products sold and the price of the products).
*/

SELECT  round (sum(price),2)  as Sum,Product 
 FROM bit_db.JanSales
 GROUP BY product;

/*
Which products were sold in February at 
548 Lincoln St, Seattle, WA 98101, how many of each were sold, and what was the total revenue?
*/

select product,quantity, quantity*price as totalrev from bit_db.FebSales
where location ='548 Lincoln St, Seattle, WA 98101';

select 
sum(Quantity), 
product, 
sum(quantity)*price as revenue
FROM BIT_DB.FebSales 
WHERE location = '548 Lincoln St, Seattle, WA 98101'
GROUP BY product


/*
How many customers ordered more than 2 products at a time in February, and what was the average amount spent for those customers?
*/


select orderID, quantity, avg(quantity*price) as Avg_Price from bit_db.FebSales
where quantity > 2

group by orderID
order by quantity asc;

select product, price, quantity,  orderID from bit_db.febsales where orderID = 151674;

select 
count(cust.acctnum), 
round (avg(quantity*price),2)
FROM BIT_DB.FebSales Feb
LEFT JOIN BIT_DB.customers cust
ON FEB.orderid=cust.order_id
WHERE Feb.Quantity>2








